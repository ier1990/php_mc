#!/usr/bin/env bash
set -e
CHANGED=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.php$' || true)
[ -z "$CHANGED" ] && exit 0
echo "PHP lint on staged files..."
ok=1
while IFS= read -r f; do
  php -l "$f" || ok=0
done <<< "$CHANGED"
[ "$ok" -eq 1 ] || { echo "✗ Lint failed"; exit 1; }
echo "✓ Lint passed"
